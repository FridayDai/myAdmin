<virtualhost *:80>
  <proxy *>
    order deny,allow
    allow from all
  </proxy>

  proxypass / http://localhost:8080/ retry=0
  proxypassreverse / http://localhost:8080/
  proxypreservehost on

  rewriteengine on
  rewritecond %{http:x-forwarded-proto} !https
  rewriterule !/healthcheck https://%{server_name}%{request_uri} [l,r]

  logformat "%h (%{x-forwarded-for}i) %l %u %t \"%r\" %>s %b \"%{referer}i\" \"%{user-agent}i\""
  errorlog /var/log/httpd/elasticbeanstalk-error_log
  transferlog /var/log/httpd/elasticbeanstalk-access_log
</virtualhost>
